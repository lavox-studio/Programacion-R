---
title: "R para Ingenier铆as y Ciencias"
author: "La Academia"
subtitle: "Tema 12 - Teor铆a"
output:
  html_document:
    df_print: paged
---

# Operaciones matriciales

Las **operaciones matriciales** en **R** son aquellas que se aplican a matrices siguiendo las **reglas del 谩lgebra lineal**. A diferencia de las **operaciones elemento a elemento**, estas operaciones consideran la estructura bidimensional de las matrices y su relaci贸n matem谩tica (dimensiones, filas y columnas).

![Caracter铆sticas de las operaciones matriciales en R.](https://github.com/aisacc/Programacion-R/blob/main/_Im%C3%A1genes/Tema%2012%20-%20Operaciones%20matriciales/1.png?raw=true){width="668"}

> Las operaciones matriciales son fundamentales en 谩reas como:
>
> -   **Ingenier铆a civil**: sistemas de ecuaciones estructurales.
>
> -   **Ingenier铆a el茅ctrica**: an谩lisis de circuitos lineales.
>
> -   **Ingenier铆a mec谩nica**: transformaciones en din谩mica de cuerpos.
>
> -   **Ingenier铆a de control**: modelos de estado y simulaci贸n.

## Multiplicaci贸n

La **multiplicaci贸n matricial** es una operaci贸n del 谩lgebra lineal en la que dos matrices se combinan para formar una nueva matriz. Esta operaci贸n **no se realiza elemento a elemento**, sino mediante la suma de productos entre filas de la primera matriz y columnas de la segunda.

Para que la multiplicaci贸n sea posible:

-   El n煤mero de **columnas** de la primera matriz debe ser igual al n煤mero de **filas** de la segunda matriz.

Si:

-   $A$ es de dimensi贸n $m \times n$

-   $B$ es de dimensi贸n $n \times p$

![Verificaci贸n de dimensiones para aplicar la multiplicaci贸n matricial.](https://github.com/aisacc/Programacion-R/blob/main/_Im%C3%A1genes/Tema%2012%20-%20Operaciones%20matriciales/2.png?raw=true){width="414"}

Entonces:

-   $A \times B$ es una matriz de dimensi贸n $m \times p$

![Dimensiones de la matriz resultante de aplicar la multiplicaci贸n matricial.](https://github.com/aisacc/Programacion-R/blob/main/_Im%C3%A1genes/Tema%2012%20-%20Operaciones%20matriciales/3.png?raw=true){width="416"}

``` r
# Sintaxis
C <- A %*% B
```

-   `%*%` es el operador de multiplicaci贸n matricial en **R**.

-   `A` y `B` deben tener dimensiones compatibles como se explic贸 arriba.

``` r
A <- matrix(c(1, 2, 3, 4), nrow = 2)    # 2x2
B <- matrix(c(5, 6, 7, 8), nrow = 2)    # 2x2

C <- A %*% B
```

```{r}
# Ingresa tu c贸digo aqu铆 
```

> La multiplicaci贸n matricial permite conectar dos sistemas de informaci贸n mediante una estructura lineal. Su correcta aplicaci贸n es esencial para modelar, simular y resolver numerosos problemas de ingenier铆a. Comprender la diferencia con la multiplicaci贸n elemento a elemento y saber cu谩ndo se puede realizar es una competencia b谩sica para el an谩lisis num茅rico y computacional.
>
> -   Multiplicar una matriz de resistencias con un vector de corrientes permite obtener el vector de ca铆das de voltaje en un circuito.
>
> -   Multiplicar una matriz de rigidez con un vector de desplazamientos produce un vector de fuerzas.

### Ejemplo

Usted y un amigo van a una tienda. Sus listas son las que se muestran en la tabla.

![Cantidad de art铆culos comprados por cada persona.](https://github.com/aisacc/Programacion-R/blob/main/_Im%C3%A1genes/Tema%2012%20-%20Operaciones%20matriciales/6.png?raw=true){width="419"}

Los art铆culos tienen los siguientes costos:

![Precio unitario de cada art铆culo.](https://github.com/aisacc/Programacion-R/blob/main/_Im%C3%A1genes/Tema%2012%20-%20Operaciones%20matriciales/7.png?raw=true){width="395"}

Encuentre la factura total para cada comprador.

> [**Nota:**]{.underline} Recuerda utilizar el enfoque EPS.

### Soluci贸n

```{r}
# Ingresa tu c贸digo aqu铆 
```

------------------------------------------------------------------------

## Potencia

La **potencia matricial** es una operaci贸n en la que una matriz se multiplica por s铆 misma varias veces. Es una extensi贸n del concepto de elevar n煤meros a una potencia, pero en este caso, se aplica a matrices. La potencia de una matriz solo est谩 definida cuando la matriz es **cuadrada** (es decir, tiene el mismo n煤mero de filas y columnas).

Si $A$ es una matriz cuadrada de dimensi贸n $n \times n$, su potencia $A^k$ (donde $k$ es un n煤mero entero positivo) se define como:

-   $A^1 = A$

-   $A^k = A \times A \times \cdots \times A$ ($k$ veces)

La potencia de una matriz no es simplemente elevar cada elemento al exponente $k$. Es una multiplicaci贸n matricial repetida.

En **R**, no hay una funci贸n nativa directamente dise帽ada para calcular potencias matriciales de forma general. Sin embargo, se puede utilizar (primero instalar y luego cargar) el paquete `expm` para hacer uso del operador de potencia matricial `%^%`.

``` r
install.packages("expm")    # Instalar paquete
library(expm)               # Cargar paquete
```

``` r
# Sintaxis
C <- A %^% 3
```

-   `%^%` es el operador de potencia matricial en **R** a trav茅s del paquete `expm`.

``` r
A <- matrix(c(1, 2, 3, 4), nrow = 2)    # 2x2

C1 <- A %^% 3           # Potencia matricial
C2 <- A %*% A %*% A     # Verificaci贸n a trav茅s de multiplicaci贸n matricial
```

```{r}
# Ingresa tu c贸digo aqu铆 
```

> La **potencia matricial** es una herramienta clave en el an谩lisis y modelado de sistemas en ingenier铆a, particularmente en 谩reas como el an谩lisis de redes, control de sistemas din谩micos y simulaciones estructurales. Comprender c贸mo realizar estas operaciones, as铆 como sus propiedades y aplicaciones, es crucial para el manejo efectivo de modelos matem谩ticos complejos.
>
> -   En la ingenier铆a de control, las potencias de matrices de transici贸n son 煤tiles para predecir el comportamiento del sistema a lo largo de varios per铆odos de tiempo.
>
> -   En redes de comunicaci贸n, la potencia de las matrices de adyacencia es utilizada para determinar la conectividad indirecta entre nodos despu茅s de m煤ltiples pasos.
>
> -   En la ingenier铆a civil y mec谩nica, la potencia de las matrices puede ayudar a modelar la propagaci贸n de esfuerzos o desplazamientos a trav茅s de una estructura bajo m煤ltiples cargas.

------------------------------------------------------------------------

## Inversa

La **inversa de una matriz** es una matriz que, al multiplicarse por la matriz original, da como resultado la **matriz identidad**. Es decir, si tienes una matriz $A$, su inversa $A^{-1}$ cumple con:

$$
A \times A^{-1} = A^{-1} \times A = I
$$

donde $I$ es la **matriz identidad** (con unos en la diagonal principal y ceros en las dem谩s posiciones).

No todas las matrices tienen inversa. Solo las **matrices cuadradas** (es decir, con el mismo n煤mero de filas y columnas) que son **no singulares** (determinante distinto de cero) tienen inversa.

En general, el c谩lculo de la inversa de una matriz $A$ se puede hacer de varias formas, incluyendo la **m茅todo de la matriz adjunta** o el **m茅todo de Gauss-Jordan**. Sin embargo, en **R**, se puede utilizar la funci贸n `solve()` para obtener la inversa de una matriz de manera directa.

``` r
# Sintaxis
A_inv <- solve(A)
```

-   `A` debe ser una matriz cuadrada.

-   `solve(A)` devuelve la inversa de `A`, si esta existe.

``` r
A <- matrix(c(4, 7, 2, 6), nrow = 2)
A_inv <- solve(A)
print(A_inv)
```

```{r}
# Ingresa tu c贸digo aqu铆 
```

> Imagina que est谩s trabajando con una estructura de vigas y necesitas encontrar las fuerzas internas a partir de los desplazamientos. Esto se puede modelar como un sistema de ecuaciones lineales que se resuelven utilizando la **inversa de una matriz** de rigidez, la cual conecta las fuerzas con los desplazamientos. Si no puedes calcular la inversa, significa que el sistema es **inestable** o **singular**.

------------------------------------------------------------------------

## Resolver sistemas de ecuaciones lineales

Un sistema lineal puede escribirse como:

$$
Ax = b
$$

Donde:

-   $A$ es la matriz de coeficientes ($m \times n$)

-   $x$ es el vector de inc贸gnitas ($n \times 1$)

-   $b$ es el vector de t茅rminos independientes ($m \times 1$)

Cuando el sistema es **cuadrado** (es decir, tiene igual n煤mero de ecuaciones que de inc贸gnitas), y la matriz $A$ es **invertible**, podemos encontrar la soluci贸n usando:

$$
x = A^{-1}b
$$

En **R**, se puede resolver un sistema lineal de forma directa usando la funci贸n `solve()`.

``` r
# Sintaxis
x <- solve(A, b)
```

Donde:

-   `A` es la matriz de coeficientes.

-   `b` es el vector de t茅rminos independientes.

-   `x` es el vector soluci贸n.

Esto es computacionalmente m谩s eficiente que calcular la inversa de `A` y luego multiplicar por `b`.

Consideremos el sistema:

$$
\begin{align}
2x + 3y &= 8 \\
4x - y &= 2
\end{align}
$$

Representamos este sistema de forma matricial como:

$$
A = 
\left(\begin{matrix}
2 & 3 \\
4 & -1
\end{matrix}\right),\
b =
\left(\begin{matrix}
8 \\
2
\end{matrix}\right)
$$

Y resolvemos con:

``` r
A <- matrix(c(2, 4, 3, -1), nrow = 2)
b <- c(8, 2)
x <- solve(A, b)
print(x)
```

Esto nos da los valores de $x$ y $y$ que satisfacen el sistema.

```{r}
# Ingresa tu c贸digo aqu铆 
```

| Resolver sistemas de ecuaciones lineales mediante herramientas matriciales es una habilidad fundamental para ingenieros de todas las disciplinas. Permite modelar fen贸menos reales y encontrar soluciones r谩pidas y precisas a problemas complejos, desde estructuras f铆sicas hasta redes computacionales.

### Ejemplo 1

Un aspecto importante en el estudio de la transferencia de calor es determinar la distribuci贸n de la temperatura en estado estable sobre una placa delgada cuando se conoce la temperatura presente alrededor de los bordes. Suponga que la placa mostrada en la figura representa la secci贸n transversal de una viga de metal, con un flujo de calor insignifi cante en la direcci贸n perpendicular a la placa. Sean $T_1, \dots, T_4$ las temperaturas en los cuatro nodos interiores de la malla que se muestra en la figura. En un nodo, la temperatura es aproximadamente igual al promedio de los cuatro nodos m谩s cercanos a la izquierda, arriba, a la derecha y abajo. Por ejemplo,

$$
T_1 = (10 + 20 + T_2 + T_4)/4, \\ \text{ o } \\4T_1 - T_2 - T_4 = 30
$$

![Malla de una placa delgada.](https://github.com/aisacc/Programacion-R/blob/main/_Im%C3%A1genes/Tema%2012%20-%20Operaciones%20matriciales/4.png?raw=true){width="285"}

Escriba un sistema de cuatro ecuaciones cuya soluci贸n proporcione un estimado para las temperaturas $T_1, \dots, T_4$, luego resuelva el sistema de ecuaciones.

> [**Nota:**]{.underline} Recuerda utilizar el enfoque EPS.

### Soluci贸n

```{r}
# Ingresa tu c贸digo aqu铆 
```

### Ejemplo 2

En un experimento de t煤nel de viento, la fuerza sobre un proyectil debida a la resistencia del aire se midi贸 a diferentes velocidades:

-   Velocidad (100 pies/seg): 0, 2, 4, 6, 8, 10

-   Fuerza (100 lb): 0, 2.90, 14.8, 39.6, 74.3, 119

Encuentre un polinomio de interpolaci贸n para estos datos y estime la fuerza sobre el proyectil cuando 茅ste viaja a 750 pies/seg. Utilice $p(t) = a_0 + a_1t + a_2t^2 + a_3t^3 + a_4t^4 + a_5t^5$.

> [**Nota:**]{.underline} Recuerda utilizar el enfoque EPS.

### Soluci贸n

```{r}
# Ingresa tu c贸digo aqu铆 
```

### Ejemplo 3

Suponga que una econom铆a consiste en los sectores de carb贸n, electricidad y acero, y que el rendimiento de cada sector se distribuye entre los diferentes sectores como en la tabla 1, donde las entradas de una columna representan fracciones de la producci贸n total de un sector. La segunda columna de la tabla 1, por ejemplo, muestra que la producci贸n total de electricidad se divide como sigue: un 40% de carb贸n, un 50% de acero, y el restante 10% de electricidad. (El sector el茅ctrico trata este 10% como un gasto en que incurre para hacer funcionar su negocio.) Ya que debe tomarse en cuenta la producci贸n total, las fracciones decimales de cada columna deben sumar 1.

![Una econom铆a sencilla.](https://github.com/aisacc/Programacion-R/blob/main/_Im%C3%A1genes/Tema%2012%20-%20Operaciones%20matriciales/5.png?raw=true){width="433"}

Los precios (es decir, valores en moneda) de la producci贸n total de los sectores de carb贸n, electricidad y acero se denotar谩n como $p_C,\ p_E$ y $p_S$, respectivamente. Si es posible, encuentre los precios de equilibrio que permiten a los ingresos de cada sector igualar sus gastos.

Por ejemplo, la primera ecuaci贸n del sistema, de la primera fila de la tabla, es:

$$
p_C = 0.0p_C + 0.4p_E + 0.6p_S
$$

De esta forma se puede ensamblar el resto de ecuaciones del sistema de ecuaciones. Una vez planteado el sistema, resu茅lvalo.

> [**Nota:**]{.underline} Recuerda utilizar el enfoque EPS.

### Soluci贸n

```{r}
# Ingresa tu c贸digo aqu铆 
```

------------------------------------------------------------------------
