---
title: "R para Ingenierías y Ciencias"
author: "La Academia"
subtitle: "Tema 20 - Práctica"
output:
  html_document:
    df_print: paged
---

# Creación de funciones personalizadas

## Ejercicio 1

Crea una función que simule la acumulación de un contaminante en un embalse, considerando entrada diaria variable y eliminación proporcional diaria. Utilice

$$
C_{t+1} = (C_t + E_t)(1 - r)
$$

donde:

-   $C_t$: concentración del día $t$

-   $E_t$: entrada diaria

-   $r$: tasa de eliminación diaria (en decimal)

Realice una prueba con estos datos:

-   Entradas: `c(10, 12, 8, 11, 9)` kg/día

-   Tasa de eliminación: 15%

-   Concentración inicial = 0

> [**Nota:**]{.underline} Recuerda utilizar el enfoque EPS.

## Solución

```{r}
# Ingresa tu código aquí 👽
```

------------------------------------------------------------------------

## Ejercicio 2

Define una función que analice un vector de tiempos de ejecución de distintas funciones y calcule el promedio móvil de orden 3 (centrado) para suavizar variaciones. Utilice

$$
PM_i = \frac{t_{i-1} + t_i + t_{i+1}}{3}
$$

Realice una prueba con estos datos:

-   Tiempos de ejecución (ms): `c(120, 130, 110, 160, 150, 140, 135)`

> [**Nota:**]{.underline} Recuerda utilizar el enfoque EPS.

## Solución

```{r}
# Ingresa tu código aquí 👽
```

------------------------------------------------------------------------

## Ejercicio 3

Escribe una función que calcule el índice de Gini de una población a partir de los ingresos ordenados crecientemente. Utilice

$$
G = \frac{\sum_{i=1}^n (2i - n - 1) x_i}{n \sum_{i=1}^n x_i}
$$

donde:

-   $x_i$: ingreso del individuo $i$

-   $n$: número total de individuos

Realice una prueba con estos datos:

-   Ingresos: `c(1000, 1200, 1500, 2000, 3500, 5000)`

> [**Nota:**]{.underline} Recuerda utilizar el enfoque EPS.

## Solución

```{r}
# Ingresa tu código aquí 👽
```

------------------------------------------------------------------------

## Ejercicio 4

Define una función que calcule la frecuencia cardíaca promedio durante un ejercicio, tomando como entrada los tiempos entre latidos (intervalos RR en milisegundos). Utilice

$$
\text{Frecuencia (bpm)} = \frac{60000}{RR}
$$

Promediar todas las frecuencias resultantes.

Realice una prueba con estos datos:

-   Intervalos RR: `c(800, 750, 780, 790, 770, 760)` ms

> [**Nota:**]{.underline} Recuerda utilizar el enfoque EPS.

## Solución

```{r}
# Ingresa tu código aquí 👽
```

------------------------------------------------------------------------

## Ejercicio 5

Crea una función que simule una tabla de amortización de un préstamo con el sistema francés (cuotas fijas). Utilice

$$
C = P \frac{i (1 + i)^n}{(1 + i)^n - 1}
$$

donde:

-   $P$: capital

-   $i$: tasa mensual

-   $n$: número de cuotas

Devuelve una tabla con: cuota, interés del mes, capital amortizado y saldo.

Realice una prueba con estos datos:

-   Capital: \$50,000

-   Tasa mensual: 1%

-   Cuotas: 12

> [**Nota:**]{.underline} Recuerda utilizar el enfoque EPS.

## Solución

```{r}
# Ingresa tu código aquí 👽
```

------------------------------------------------------------------------
